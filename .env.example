# ============================================================
# Portal Configuration
# Copy to .env and fill in values. NEVER commit .env.
# ============================================================

# --- Hardware ---
# Options: mps (Apple Silicon) | cuda (NVIDIA) | cpu
COMPUTE_BACKEND=mps
# Options: host.docker.internal (macOS) | 172.17.0.1 (Linux bare) | 0.0.0.0 (WSL2)
DOCKER_HOST_IP=host.docker.internal
# Options: launchagent (macOS) | systemd (Linux) | nohup (WSL2)
SUPERVISOR_TYPE=launchagent

# --- LLM ---
OLLAMA_HOST=http://localhost:11434
DEFAULT_MODEL=qwen2.5:7b

# --- Routing ---
ROUTER_PORT=8000
ROUTER_BIND_IP=127.0.0.1
# Optional auth token for router
# ROUTER_TOKEN=

# --- Web UI (pick one) ---
# Options: openwebui | librechat
WEB_UI=openwebui

# --- Web UI Authentication ---
# Set to true to enable Open WebUI user accounts and login screen.
# First user to sign up becomes admin. Default: false (open access).
# WEBUI_AUTH=false

# --- MCP ---
MCP_ENABLED=true
# REQUIRED — replace with a strong random secret before first boot.
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# Portal will refuse to start if this is still set to the default value.
MCP_API_KEY=changeme-mcp-secret
# Options: mcpo (for Open WebUI) | native (for LibreChat)
MCP_TRANSPORT=mcpo
MCPO_PORT=9000

# --- Generation Services (M4 default: true, Linux: false) ---
GENERATION_SERVICES=true
COMFYUI_URL=http://localhost:8188

# --- Telegram (optional channel) ---
TELEGRAM_ENABLED=false
# TELEGRAM_BOT_TOKEN=
# TELEGRAM_USER_IDS=123456789,987654321

# --- Slack (optional channel) ---
SLACK_ENABLED=false
# SLACK_BOT_TOKEN=xoxb-...
# SLACK_SIGNING_SECRET=
# SLACK_CHANNEL_WHITELIST=#ai-ops,#dev-tools

# --- Security ---
# REQUIRED — Portal refuses to start in production without this key.
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
PORTAL_BOOTSTRAP_API_KEY=changeme-bootstrap-key
RATE_LIMIT_PER_MINUTE=60
SANDBOX_ENABLED=false
APPROVAL_REQUIRED=true

# --- Web API authentication ---
# Set WEB_API_KEY to require all /v1/* requests to present a Bearer token.
# When WEB_API_KEY is set, REQUIRE_API_KEY automatically defaults to true.
# To disable auth for local-only use (loopback interface only), leave both unset.
# WARNING: if the Portal API port is exposed beyond localhost, always set WEB_API_KEY.
# WEB_API_KEY=
# REQUIRE_API_KEY=true

# --- Observability ---
LOG_LEVEL=INFO
METRICS_ENABLED=true
METRICS_PORT=9090
WATCHDOG_ENABLED=true

# --- Vision ---
# Model used for vision/image tasks (falls back to DEFAULT_MODEL if unset)
# PORTAL_VISION_MODEL=llava:7b

# --- Web Security Headers ---
# Content-Security-Policy header value (default: strict policy applied)
# PORTAL_CSP=default-src 'self'
# Enable HTTP Strict Transport Security header (default: false)
# PORTAL_HSTS=false

# --- Audio ---
# Maximum allowed audio upload size in megabytes (default: 25)
# PORTAL_MAX_AUDIO_MB=25

# --- WebSocket Rate Limiting ---
# Maximum WebSocket messages per window (default: 30)
# WS_RATE_LIMIT=30
# WebSocket rate limit window in seconds (default: 60)
# WS_RATE_WINDOW=60

# --- Context & Memory Retention ---
# Days to retain conversation context (default: 30)
# PORTAL_CONTEXT_RETENTION_DAYS=30
# Days to retain memory entries (default: 90)
# PORTAL_MEMORY_RETENTION_DAYS=90
